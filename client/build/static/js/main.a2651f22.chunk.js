(this["webpackJsonpcmhs-front"]=this["webpackJsonpcmhs-front"]||[]).push([[0],{28:function(e,t){t.timestampToDate=function(e){},t.timestamptToTimeAgo=function(e){var t=(Date.now()-72e5)/1e3,a=Math.round(t-e)/60;return a>=60?Math.round(a/60)+" hours ago":0===(a=Math.round(a))?"Just now":a+" minutes ago"},t.convertToDate=function(e){var t=new Date(e),a=t.getDay(),n=t.getMonth(),r=t.getFullYear(),c=t.getHours(),l="0"+t.getMinutes(),o="0"+t.getSeconds();return c+":"+l.substr(-2)+":"+o.substr(-2)+"   "+a+"/"+n+"-"+r}},67:function(e,t,a){e.exports=a.p+"static/media/ntnu_logo.9b4c0ba4.png"},72:function(e,t,a){e.exports=a(85)},77:function(e,t,a){},85:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),l=a(25),o=a.n(l),s=(a(77),a(12)),u=a(43),i=a(6),m=a.n(i),p=a(13),d=a(7),h=a(100),E=a(64),f=a(93),b=a(90),g=function(e){return c.a.createElement("tr",null,Object.keys(e).map((function(t){return c.a.createElement("td",{key:t},e[t])})))},v=function(e){return 0===e.content.objects.length?c.a.createElement("div",null,c.a.createElement("h2",null,"No content available")):c.a.createElement("div",null,c.a.createElement(b.a,{responsive:"sm"},c.a.createElement("thead",null,c.a.createElement("tr",null,e.content.headers.map((function(e){return c.a.createElement("th",{key:e},e)})))),c.a.createElement("tbody",null,e.content.objects.map((function(e){return c.a.createElement(g,Object.assign({key:e.id},e))})))))},y=a(28),x=a.n(y),j=function(e){for(var t=[],a=0;a<e.content.objects.length;a++){var n=e.content.objects[a],r={};try{r.id=n.name,r.zone=n.zone,r.lastseen=x.a.timestamptToTimeAgo(n.lastseen)}catch(o){console.log("Something went wrong accessing the array")}t.push(r)}var l={objects:t,headers:["Tag ID","Zone","Last seen"]};return c.a.createElement(h.a,{className:"text-left shadow-sm p-3 mb-5 bg-white rounded"},c.a.createElement(h.a.Body,null,c.a.createElement(h.a.Title,null,e.title),c.a.createElement(h.a.Text,null,e.description),c.a.createElement(h.a.Body,null,c.a.createElement(v,{content:l}))))},w=function(e){for(var t=[],a=0;a<e.content.objects.length;a++){var n=e.content.objects[a],r={};try{r.id=n.name,r.workstatus=n.workstatus,r.status=n.status,r.zone=n.zone,r.lastseen=x.a.timestamptToTimeAgo(n.lastseen)}catch(o){console.log("Something went wrong accessing the array")}t.push(r)}var l={objects:t,headers:["Tag ID","Workstatus","Status","Zone","Last seen"]};return c.a.createElement(h.a,{className:"text-left shadow-sm p-3 mb-5 bg-white rounded"},c.a.createElement(h.a.Body,null,c.a.createElement(h.a.Title,null,e.title),c.a.createElement(h.a.Text,null,e.description),c.a.createElement(h.a.Body,null,c.a.createElement(v,{content:l}))))},O=a(101),k=a(92),C=function(e){for(var t=["Description","Work Status","Created"],a=[],n=0;n<e.jobs.length;n++){var r=e.jobs[n],l={};try{l.id=r.description,l.workstatus=r.workstatus,l.created=x.a.convertToDate(r.timecreated),r.timeassigned&&(t.push("Assigned"),l.assigned=x.a.convertToDate(r.timeassigned)),r.timecompleted&&(t.push("Completed"),l.completed=x.a.convertToDate(r.timecompleted))}catch(s){console.log("Something went wrong accessing the array")}a.push(l)}var o={objects:a,headers:t};return c.a.createElement(h.a,{className:"text-left shadow-sm p-3 mb-5 bg-white rounded"},c.a.createElement(h.a.Body,null,e.title&&c.a.createElement(c.a.Fragment,null,c.a.createElement(h.a.Title,null,e.title),c.a.createElement(h.a.Text,null,e.description)),c.a.createElement(h.a.Body,null,c.a.createElement(v,{content:o}))))},S=a(91),T=function(e){return c.a.createElement(S.a,{animation:"border",role:"status"},c.a.createElement("span",{className:"sr-only"},"Loading..."))},D=function(){var e=Object(r.useState)(!1),t=Object(d.a)(e,2),a=t[0],n=t[1],c=Object(r.useState)(),l=Object(d.a)(c,2),o=l[0],s=l[1],u=Object(r.useRef)([]),i=Object(r.useCallback)(function(){var e=Object(p.a)(m.a.mark((function e(t){var a,r,c,l,o,i,p=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=p.length>1&&void 0!==p[1]?p[1]:"GET",r=p.length>2&&void 0!==p[2]?p[2]:null,c=p.length>3&&void 0!==p[3]?p[3]:{},n(!0),l=new AbortController,u.current.push(l),e.prev=6,e.next=9,fetch(t,{method:a,body:r,headers:c,signal:l.signal});case 9:return o=e.sent,e.next=12,o.json();case 12:if(i=e.sent,u.current=u.current.filter((function(e){return e!==l})),o.ok){e.next=17;break}throw n(!1),new Error(i.message);case 17:return n(!1),e.abrupt("return",i);case 21:throw e.prev=21,e.t0=e.catch(6),s(e.t0.message),n(!1),e.t0;case 26:case"end":return e.stop()}}),e,null,[[6,21]])})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(r.useEffect)((function(){return function(){u.current.forEach((function(e){return e.abort()}))}}),[]),{isLoading:a,error:o,sendRequest:i,clearError:function(){s(null)}}},L=function(e){var t=Object(r.useState)("scheduled"),a=Object(d.a)(t,2),n=a[0],l=a[1],o=Object(r.useState)(),s=Object(d.a)(o,2),u=s[0],i=s[1],E=D(),f=E.isLoading,b=E.sendRequest,g="/jobs/table/"+n;return Object(r.useEffect)((function(){(function(){var e=Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b("https://cmhs-ntnu.herokuapp.com/api"+g);case 3:t=e.sent,i(t.jobs),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Cold not fetch");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[b,n,g]),c.a.createElement(h.a,{style:{marginLeft:"20px",marginRight:"20px",marginBottom:"25px"}},c.a.createElement(h.a.Header,null,c.a.createElement(h.a.Title,null,"Jobs"),c.a.createElement(O.a,{id:"controlled-tab-example",activeKey:n,onSelect:function(e){return l(e)}},c.a.createElement(k.a,{eventKey:"scheduled",title:"Scheduled"}),c.a.createElement(k.a,{eventKey:"unscheduled",title:"Unscheduled"}),c.a.createElement(k.a,{eventKey:"completed",title:"Completed"}))),c.a.createElement(h.a.Body,null,c.a.createElement(c.a.Fragment,null,u&&!f&&c.a.createElement(C,{jobs:u,type:n}),f&&c.a.createElement("div",{className:"center"},c.a.createElement(T,null)))))},I=a(96),N=function(e){var t=Object(r.useState)(!0),a=Object(d.a)(t,2),n=a[0],l=a[1],o=function(){l(!1),e.clear()};return c.a.createElement(c.a.Fragment,null,c.a.createElement(I.a,{show:n,onHide:o},c.a.createElement(I.a.Header,{closeButton:!0},c.a.createElement(I.a.Title,null,e.heading)),c.a.createElement(I.a.Body,null,e.error),c.a.createElement(I.a.Footer,null,c.a.createElement(E.a,{variant:"secondary",onClick:o},"Close"),e.save&&c.a.createElement(E.a,{variant:"primary",onClick:o},"Save Changes"))))},B=function(){var e=Object(p.a)(m.a.mark((function e(t,a){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a("https://cmhs-ntnu.herokuapp.com/api/so");case 3:return n=e.sent,t(n),e.abrupt("return",!0);case 8:return e.prev=8,e.t0=e.catch(0),console.log("Could not fetch SOs"),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}(),R=function(){var e=Object(p.a)(m.a.mark((function e(t,a){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a("https://cmhs-ntnu.herokuapp.com/api/mhm");case 3:return n=e.sent,t(n),e.abrupt("return",!0);case 8:return e.prev=8,e.t0=e.catch(0),console.log("Could not fetch MHMs",e.t0),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}(),M=function(){var e=Object(p.a)(m.a.mark((function e(t,a){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a("https://cmhs-ntnu.herokuapp.com/api/jobs");case 3:return n=e.sent,t(n),e.abrupt("return",!0);case 8:return e.prev=8,e.t0=e.catch(0),console.log("Could not fetch Jobs"),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}(),G=function(){var e=Object(p.a)(m.a.mark((function e(t,a,n,r){var c,l,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B(t,r);case 3:return c=e.sent,e.next=6,R(a,r);case 6:return l=e.sent,e.next=9,M(n,r);case 9:if(o=e.sent,!(c&&l&&o)){e.next=12;break}return e.abrupt("return","success");case 12:return e.abrupt("return","failed");case 15:e.prev=15,e.t0=e.catch(0),console.log("[requestDashboardData], An error occured",e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,a,n,r){return e.apply(this,arguments)}}(),J=function(){var e=Object(r.useState)(),t=Object(d.a)(e,2),a=t[0],n=t[1],l=Object(r.useState)(),o=Object(d.a)(l,2),s=o[0],u=o[1],i=Object(r.useState)(),b=Object(d.a)(i,2),g=b[0],v=b[1],y=D(),x=y.error,O=y.sendRequest,k=y.clearError,C=Object(r.useState)(!1),S=Object(d.a)(C,2),T=S[0],I=S[1],B=Object(r.useState)(!1),R=Object(d.a)(B,2),M=R[0],J=R[1];Object(r.useEffect)((function(){G(n,u,v,O);var e=setInterval(Object(p.a)(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,G(n,u,v,O);case 2:"failed"===t.sent&&clearInterval(e);case 4:case"end":return t.stop()}}),t)}))),1e4);return function(){return clearInterval(e)}}),[O]);var H,F,q=function(){var e=Object(p.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O("https://cmhs-ntnu.herokuapp.com/api/lifecycle/mqtt","POST",JSON.stringify({mqttstatus:t}),{"Content-Type":"application/json"});case 3:e.sent.success&&("activate"===t&&I(!0),"shutdown"===t&&I(!1)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Something went wrong in the post request");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(p.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O("https://cmhs-ntnu.herokuapp.com/api/lifecycle/ae","POST",JSON.stringify({aestatus:t}),{"Content-Type":"application/json"});case 3:e.sent.success&&("activate"===t&&J(!0),"shutdown"===t&&J(!1)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Something went wrong starting or shutting down the assignment engine");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return T||(H=c.a.createElement(h.a,{border:"white",className:"text-right",onClick:function(){return q("activate")}},c.a.createElement(E.a,{size:"sm",variant:"outline-primary"},"Connect MQTT"))),T&&(H=c.a.createElement(h.a,{border:"white",className:"text-right",onClick:function(){return q("shutdown")}},c.a.createElement(E.a,{size:"sm",variant:"outline-warning"},"Disconnect MQTT"))),M||(F=c.a.createElement(h.a,{border:"white",className:"text-right",onClick:function(){return z("activate")}},c.a.createElement(E.a,{size:"sm",variant:"outline-primary"},"Start Assignment Engine"))),M&&(F=c.a.createElement(h.a,{border:"white",className:"text-right",onClick:function(){return z("shutdown")}},c.a.createElement(E.a,{size:"sm",variant:"outline-warning"},"Shutdown Assignment Engine"))),c.a.createElement("div",null,c.a.createElement(h.a,{border:"light"},c.a.createElement(h.a.Body,null,c.a.createElement("div",{style:{width:"100%",overflow:"hidden"}},c.a.createElement("div",{style:{width:"80%",float:"left"}},c.a.createElement("h1",null,"Dashboard")),c.a.createElement("div",{style:{marginLeft:"150px",marginBottom:"5px"}},H),c.a.createElement("div",{style:{marginLeft:"150px",marginTop:"5px"}},F)),c.a.createElement("hr",{style:{marginTop:"20px",align:"center",width:"99.7%"}}))),x&&c.a.createElement(N,{heading:"Backend fetch failed",error:x,save:!1,clear:k}),s&&a&&g&&c.a.createElement(c.a.Fragment,null,c.a.createElement(L,{style:{margin:"5px"},jobs:g}),c.a.createElement(f.a,{style:{margin:"5px",marginBottom:"15px"}},c.a.createElement(j,{title:"Smart Objects",description:"Objects to be picked up and delivered at specified locations.",content:a}),c.a.createElement(w,{title:"Material Handling Modules",description:"Handlers able to transport Smart Objects.",content:s}))))},H=a(22),F=a(97),q=a(66),z=function(){var e,t=Object(r.useState)(),a=Object(d.a)(t,2),n=a[0],l=a[1],o=Object(r.useState)({description:"",fromxcoord:null,fromycoord:null,toxcoord:null,toycoord:null,so:null}),u=Object(d.a)(o,2),i=u[0],f=u[1],b=Object(r.useState)(!1),g=Object(d.a)(b,2),v=g[0],y=g[1],x=D(),j=x.isLoading,w=x.error,O=x.sendRequest,k=x.clearError;Object(r.useEffect)((function(){(function(){var e=Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O("https://cmhs-ntnu.herokuapp.com/api/so");case 3:t=e.sent,l(t.objects),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[O]),n&&(e=n.map((function(e){return c.a.createElement("option",{key:e.id,value:e.id},"Tag ",e.name)})));var C=function(){var e=Object(p.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a={description:i.description,from:{x:i.fromxcoord,y:i.fromycoord},to:{x:i.toxcoord,y:i.toycoord},soid:i.so},e.prev=2,e.next=5,O("https://cmhs-ntnu.herokuapp.com/api/jobs","POST",JSON.stringify(a),{"Content-Type":"application/json"});case 5:e.sent.success&&y(!0),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(w);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),S=function(e){var t=e.target,a=t.id,n=t.value,r=Object(H.a)({},i);r[a]=n,f(Object(H.a)({},r))};return v?c.a.createElement(s.a,{to:"/dashboard"}):c.a.createElement(h.a,{style:{margin:"20px"}},c.a.createElement(h.a.Header,null,c.a.createElement(h.a.Title,{style:{marginTop:"10px"}},"Create Job")),c.a.createElement(h.a.Body,null,w&&c.a.createElement(N,{heading:"Something went wrong",error:w,save:!1,clear:k}),j&&c.a.createElement(T,null),!j&&c.a.createElement(F.a,{onSubmit:C},c.a.createElement(F.a.Group,null,c.a.createElement(F.a.Label,null,"Description"),c.a.createElement(F.a.Row,null,c.a.createElement(q.a,{xs:6},c.a.createElement(F.a.Control,{id:"description",type:"text",placeholder:"Enter description",onChange:S})))),c.a.createElement(F.a.Group,null,c.a.createElement(F.a.Label,null,"From Location"),c.a.createElement(F.a.Row,null,c.a.createElement(q.a,{xs:3},c.a.createElement(F.a.Control,{id:"fromxcoord",type:"number",placeholder:"X-Coordinate",onChange:S})),c.a.createElement(q.a,{xs:3},c.a.createElement(F.a.Control,{id:"fromycoord",type:"number",placeholder:"Y-Coordinate",onChange:S})))),c.a.createElement(F.a.Group,null,c.a.createElement(F.a.Label,null,"To Location"),c.a.createElement(F.a.Row,null,c.a.createElement(q.a,{xs:3},c.a.createElement(F.a.Control,{id:"toxcoord",type:"number",placeholder:"X-Coordinate",onChange:S})),c.a.createElement(q.a,{xs:3},c.a.createElement(F.a.Control,{id:"toycoord",type:"number",placeholder:"Y-Coordinate",onChange:S})))),c.a.createElement(F.a.Group,null,c.a.createElement(F.a.Label,{className:"mr-sm-2",htmlFor:"chooseSO"},"Choose Smart Object"),c.a.createElement(F.a.Row,null,c.a.createElement(q.a,{xs:6},c.a.createElement(F.a.Control,{as:"select",className:"mr-sm-2",id:"so",custom:!0,onChange:S},c.a.createElement("option",{default:!0,value:null},"---"),e)))),c.a.createElement(E.a,{variant:"primary",type:"submit"},"Submit"))))},A=function(){var e=Object(r.useState)({name:null,type:"",agv:!1,forklift:!1,manual:!1,description:""}),t=Object(d.a)(e,2),a=t[0],n=t[1],l=Object(r.useState)(!1),o=Object(d.a)(l,2),u=o[0],i=o[1],f=D(),b=f.isLoading,g=f.error,v=f.sendRequest,y=f.clearError,x=function(){var e=Object(p.a)(m.a.mark((function e(t){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),"so"===(n={name:a.name,type:a.type,transportclass:{agv:a.agv,forklift:a.forklift,manual:a.manual},description:a.description}).type&&(r="/so"),"mhm"===n.type&&(r="/mhm"),e.prev=4,e.next=7,v("https://cmhs-ntnu.herokuapp.com/api"+r,"POST",JSON.stringify(n),{"Content-Type":"application/json"});case 7:e.sent.success&&i(!0),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.log(g);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}(),j=function(e){var t=e.target,r=t.id,c=t.value,l=Object(H.a)({},a);l[r]=c,n(Object(H.a)({},l))},w=function(e){var t=e.target,r=t.id,c=t.checked,l=Object(H.a)({},a);l[r]=c,n(Object(H.a)({},l))};return u?c.a.createElement(s.a,{to:"/dashboard"}):c.a.createElement(h.a,{style:{margin:"20px"}},c.a.createElement(h.a.Header,null,c.a.createElement(h.a.Title,{style:{marginTop:"10px"}},"Create Tag")),c.a.createElement(h.a.Body,null,g&&c.a.createElement(N,{heading:"Something went wrong",error:g,save:!1,clear:y}),b&&c.a.createElement(T,null),!b&&c.a.createElement(F.a,{onSubmit:x},c.a.createElement(F.a.Group,null,c.a.createElement(F.a.Label,null,"Name (ID in pozyx)"),c.a.createElement(F.a.Row,null,c.a.createElement(q.a,{xs:3},c.a.createElement(F.a.Control,{id:"name",type:"text",placeholder:"Enter ID number for Tag",onChange:j})))),c.a.createElement(F.a.Group,null,c.a.createElement(F.a.Label,null,"Type"),c.a.createElement(F.a.Row,null,c.a.createElement(q.a,{xs:3},c.a.createElement(F.a.Control,{as:"select",className:"mr-sm-2",id:"type",custom:!0,onChange:j},c.a.createElement("option",{default:!0,value:null},"---"),c.a.createElement("option",{value:"so"},"Smart Object"),c.a.createElement("option",{value:"mhm"},"Material Handling Module"))))),c.a.createElement(F.a.Group,null,c.a.createElement(F.a.Label,null,"Transport Class"),c.a.createElement(F.a.Row,null,c.a.createElement(q.a,{xs:6},c.a.createElement(F.a.Check,{inline:!0,label:"AGV",type:"checkbox",id:"agv",onChange:w}),c.a.createElement(F.a.Check,{inline:!0,label:"Forklift",type:"checkbox",id:"forklift",onChange:w}),c.a.createElement(F.a.Check,{inline:!0,label:"Manual",type:"checkbox",id:"manual",onChange:w})))),c.a.createElement(F.a.Group,null,c.a.createElement(F.a.Label,null,"Description"),c.a.createElement(F.a.Row,null,c.a.createElement(q.a,{xs:6},c.a.createElement(F.a.Control,{id:"description",type:"text",placeholder:"Enter description",onChange:j})))),c.a.createElement(E.a,{variant:"primary",type:"submit"},"Submit"))))},P={display:"block",padding:"20px",height:"60px",width:"100%"},K={backgroundColor:"#343a40",borderTop:"1px solid #E7E7E7",textAlign:"right",position:"fixed",left:"0",bottom:"0",height:"30px",width:"100%"},Y={marginTop:"5px",marginRight:"15px",color:"darkGrey",fontSize:"small",display:"block"},U=new Date,Q=function(){return c.a.createElement("div",null,c.a.createElement("div",{style:P}),c.a.createElement("div",{style:K},c.a.createElement("p",{style:Y},"\xa9 ",U.getUTCFullYear()," Dept. of Mechanical and Industrial Engineering, NTNU")))},W=Object(r.createContext)({isLoggedIn:!1,token:null,userId:null,login:function(){},logout:function(){}}),X=a(99),Z=a(70),V=a(98),_=a(67),$=a.n(_),ee=function(){var e=Object(r.useContext)(W);return c.a.createElement(X.a,{bg:"dark",variant:"dark"},c.a.createElement(X.a.Brand,{href:"/dashboard"}," ",c.a.createElement("img",{style:{paddingRight:"10px",width:"40px"},src:$.a,alt:"LOGO"}),"Cloud Material Handling System"),e.isLoggedIn&&c.a.createElement(c.a.Fragment,null,c.a.createElement(Z.a,{className:"mr-auto"},c.a.createElement(Z.a.Link,{href:"/dashboard"},"Dashboard"),c.a.createElement(V.a,{title:"Create new",id:"nav-dropdown"},c.a.createElement(V.a.Item,{href:"/create/job"},"Job"),c.a.createElement(V.a.Divider,null),c.a.createElement(V.a.Item,{href:"/create/tag"},"Tag"))),c.a.createElement(Z.a,null,c.a.createElement(Z.a.Link,{onClick:e.logout},"Sign out"))))},te=a(94),ae=a(95),ne=function(){var e=Object(r.useContext)(W),t=Object(r.useState)({email:"",password:""}),a=Object(d.a)(t,2),n=a[0],l=a[1],o=D(),s=o.error,u=o.sendRequest,i=o.clearError,f=function(){var t=Object(p.a)(m.a.mark((function t(a){var r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,u("https://cmhs-ntnu.herokuapp.com/api/login/login","POST",JSON.stringify({email:n.email,password:n.password}),{"Content-Type":"application/json"});case 4:r=t.sent,e.login(r.userId,r.token),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.log("login failed");case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}(),b=function(e){var t=e.target,a=t.id,r=t.value,c=Object(H.a)({},n);c[a]=r,l(Object(H.a)({},c))};return c.a.createElement(te.a,{style:{justifyContent:"center",display:"flex",alginItems:"center",marginTop:"200px"}},s&&c.a.createElement(N,{heading:"Login failed",error:s,save:!1,clear:i}),c.a.createElement(ae.a,null,c.a.createElement(h.a,{style:{width:"500px"}},c.a.createElement(h.a.Header,{className:"text-center"},"Please enter login credentials"),c.a.createElement(h.a.Body,null,c.a.createElement(F.a,{onSubmit:f},c.a.createElement(F.a.Group,null,c.a.createElement(F.a.Label,null,"Email address"),c.a.createElement(F.a.Control,{id:"email",type:"email",placeholder:"Enter email",onChange:b})),c.a.createElement(F.a.Group,null,c.a.createElement(F.a.Label,null,"Password"),c.a.createElement(F.a.Control,{id:"password",type:"password",placeholder:"Password",onChange:b})),c.a.createElement(E.a,{variant:"primary",block:!0,type:"submit"},"LOG IN"))))))},re=function(){var e,t=function(){var e=Object(r.useState)(!1),t=Object(d.a)(e,2),a=t[0],c=t[1],l=Object(r.useState)(),o=Object(d.a)(l,2),s=o[0],u=o[1],i=Object(r.useState)(),m=Object(d.a)(i,2),p=m[0],h=m[1],E=Object(r.useCallback)((function(e,t,a){c(t),h(e);var n=a||new Date((new Date).getTime()+36e5);u(n),localStorage.setItem("userData",JSON.stringify({userId:e,token:t,expiration:n.toISOString()}))}),[]),f=Object(r.useCallback)((function(){c(null),u(null),h(null),localStorage.removeItem("userData")}),[]);return Object(r.useEffect)((function(){if(a&&s){var e=s.getTime()-(new Date).getTime();n=setTimeout(f,e)}else clearTimeout(n)}),[a,f,s]),Object(r.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userData"));e&&e.token&&new Date(e.expiration)>new Date&&E(e.userId,e.token,new Date(e.expiration))}),[E]),{token:a,login:E,logout:f,userId:p}}(),a=t.token,l=t.login,o=t.logout,i=t.userId;return e=a?c.a.createElement(s.d,null,c.a.createElement(s.b,{path:"/create/job",exact:!0},c.a.createElement(z,null)),c.a.createElement(s.b,{path:"/create/tag",exact:!0},c.a.createElement(A,null)),c.a.createElement(s.b,{path:"/dashboard",exact:!0},c.a.createElement(J,null)),c.a.createElement(s.a,{to:"/dashboard"})):c.a.createElement(ne,null),c.a.createElement(W.Provider,{value:{isLoggedIn:!!a,token:a,userId:i,login:l,logout:o}},c.a.createElement(u.a,null,c.a.createElement(ee,null),c.a.createElement("main",null,e)),c.a.createElement(Q,null))};o.a.render(c.a.createElement(re,null),document.getElementById("root"))}},[[72,1,2]]]);
//# sourceMappingURL=main.a2651f22.chunk.js.map